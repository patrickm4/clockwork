<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Clock Work Forged</title>

    <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline';" />

    <link href="https://fonts.googleapis.com/css?family=M+PLUS+Rounded+1c&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="index.css">
  </head>
  <body>
    <!-- <h1>ðŸ’– Hello World!</h1> -->
    <div id="clock"></div>
    <div
      class="btn-group"
    >
      <button id="start" class="button">
        Start
      </button>
      <button id="end" class="button">
        end
      </button>
      <button id="clear-list" class="button">
        Clear List
      </button>
    </div>
    <div id="times"></div>
    <script type="text/javascript">
      // window.moment = require ('node_modules/moment/moment.js')
      const moment = require('moment');
      var start = document.getElementById('start');
      var end = document.getElementById('end');
      var clear = document.getElementById('clear-list');
      var list = document.getElementById('times');

      const postTime = (type) => {
        const curDate = new Date();
        var newDiv = document.createElement('div')

        newDiv.innerHTML = `${type} ${moment(curDate).format('llll')}`;

        list.append(newDiv)

        return curDate
      }

      start.addEventListener('click', () =>{
        var curTime = postTime('start')
        // console.log("yeeet", curTime)
        localStorage.setItem('currentTime', curTime);
      });

      end.addEventListener('click', () =>{
        var curTime = postTime('end')
        var startTime = localStorage.getItem('currentTime')
        const duration = moment.duration(moment(curTime).diff(moment(startTime), 'hours', true))
        var newDiv = document.createElement('div')

        newDiv.innerHTML = `Duration: ${duration.asHours()} hrs`

        list.append(newDiv)

        console.log("yaaw", duration._data.hours, duration._data, duration.asHours() )
        console.log("yaaw2", startTime, curTime)

      });

      clear.addEventListener('click', () => {
        list.innerHTML = "";
        localStorage.clear();
      });

      var timeInterval = window.setInterval(getTime, 1000);

      function getTime() {
        const curDate = new Date()
        document.getElementById('clock').innerHTML = moment(curDate).format('LT');
      }

      window.onload = () => {
        getTime();
      }

    </script>
  </body>
</html>
